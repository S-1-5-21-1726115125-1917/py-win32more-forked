from win32more import *
import win32more.System.Antimalware
import win32more.Foundation
import win32more.System.Com

def __getattr__(name):
    if f"_define_{name}" not in globals():
        raise AttributeError()
    setattr(win32more.System.Antimalware, name, globals()[f"_define_{name}"]())
    return getattr(win32more.System.Antimalware, name)
def __dir__():
    return __all__
AMSI_RESULT = Int32
AMSI_RESULT_CLEAN = 0
AMSI_RESULT_NOT_DETECTED = 1
AMSI_RESULT_BLOCKED_BY_ADMIN_START = 16384
AMSI_RESULT_BLOCKED_BY_ADMIN_END = 20479
AMSI_RESULT_DETECTED = 32768
AMSI_ATTRIBUTE = Int32
AMSI_ATTRIBUTE_APP_NAME = 0
AMSI_ATTRIBUTE_CONTENT_NAME = 1
AMSI_ATTRIBUTE_CONTENT_SIZE = 2
AMSI_ATTRIBUTE_CONTENT_ADDRESS = 3
AMSI_ATTRIBUTE_SESSION = 4
AMSI_ATTRIBUTE_REDIRECT_CHAIN_SIZE = 5
AMSI_ATTRIBUTE_REDIRECT_CHAIN_ADDRESS = 6
AMSI_ATTRIBUTE_ALL_SIZE = 7
AMSI_ATTRIBUTE_ALL_ADDRESS = 8
AMSI_ATTRIBUTE_QUIET = 9
AMSI_UAC_REQUEST_TYPE = Int32
AMSI_UAC_REQUEST_TYPE_EXE = 0
AMSI_UAC_REQUEST_TYPE_COM = 1
AMSI_UAC_REQUEST_TYPE_MSI = 2
AMSI_UAC_REQUEST_TYPE_AX = 3
AMSI_UAC_REQUEST_TYPE_PACKAGED_APP = 4
AMSI_UAC_REQUEST_TYPE_MAX = 5
AMSI_UAC_TRUST_STATE = Int32
AMSI_UAC_TRUST_STATE_TRUSTED = 0
AMSI_UAC_TRUST_STATE_UNTRUSTED = 1
AMSI_UAC_TRUST_STATE_BLOCKED = 2
AMSI_UAC_TRUST_STATE_MAX = 3
AMSI_UAC_MSI_ACTION = Int32
AMSI_UAC_MSI_ACTION_INSTALL = 0
AMSI_UAC_MSI_ACTION_UNINSTALL = 1
AMSI_UAC_MSI_ACTION_UPDATE = 2
AMSI_UAC_MSI_ACTION_MAINTENANCE = 3
AMSI_UAC_MSI_ACTION_MAX = 4
def _define_AMSI_UAC_REQUEST_EXE_INFO_head():
    class AMSI_UAC_REQUEST_EXE_INFO(Structure):
        pass
    return AMSI_UAC_REQUEST_EXE_INFO
def _define_AMSI_UAC_REQUEST_EXE_INFO():
    AMSI_UAC_REQUEST_EXE_INFO = win32more.System.Antimalware.AMSI_UAC_REQUEST_EXE_INFO_head
    AMSI_UAC_REQUEST_EXE_INFO._fields_ = [
        ("ulLength", UInt32),
        ("lpwszApplicationName", win32more.Foundation.PWSTR),
        ("lpwszCommandLine", win32more.Foundation.PWSTR),
        ("lpwszDLLParameter", win32more.Foundation.PWSTR),
    ]
    return AMSI_UAC_REQUEST_EXE_INFO
def _define_AMSI_UAC_REQUEST_COM_INFO_head():
    class AMSI_UAC_REQUEST_COM_INFO(Structure):
        pass
    return AMSI_UAC_REQUEST_COM_INFO
def _define_AMSI_UAC_REQUEST_COM_INFO():
    AMSI_UAC_REQUEST_COM_INFO = win32more.System.Antimalware.AMSI_UAC_REQUEST_COM_INFO_head
    AMSI_UAC_REQUEST_COM_INFO._fields_ = [
        ("ulLength", UInt32),
        ("lpwszServerBinary", win32more.Foundation.PWSTR),
        ("lpwszRequestor", win32more.Foundation.PWSTR),
        ("Clsid", Guid),
    ]
    return AMSI_UAC_REQUEST_COM_INFO
def _define_AMSI_UAC_REQUEST_MSI_INFO_head():
    class AMSI_UAC_REQUEST_MSI_INFO(Structure):
        pass
    return AMSI_UAC_REQUEST_MSI_INFO
def _define_AMSI_UAC_REQUEST_MSI_INFO():
    AMSI_UAC_REQUEST_MSI_INFO = win32more.System.Antimalware.AMSI_UAC_REQUEST_MSI_INFO_head
    AMSI_UAC_REQUEST_MSI_INFO._fields_ = [
        ("ulLength", UInt32),
        ("MsiAction", win32more.System.Antimalware.AMSI_UAC_MSI_ACTION),
        ("lpwszProductName", win32more.Foundation.PWSTR),
        ("lpwszVersion", win32more.Foundation.PWSTR),
        ("lpwszLanguage", win32more.Foundation.PWSTR),
        ("lpwszManufacturer", win32more.Foundation.PWSTR),
        ("lpwszPackagePath", win32more.Foundation.PWSTR),
        ("lpwszPackageSource", win32more.Foundation.PWSTR),
        ("ulUpdates", UInt32),
        ("ppwszUpdates", POINTER(win32more.Foundation.PWSTR)),
        ("ppwszUpdateSources", POINTER(win32more.Foundation.PWSTR)),
    ]
    return AMSI_UAC_REQUEST_MSI_INFO
def _define_AMSI_UAC_REQUEST_AX_INFO_head():
    class AMSI_UAC_REQUEST_AX_INFO(Structure):
        pass
    return AMSI_UAC_REQUEST_AX_INFO
def _define_AMSI_UAC_REQUEST_AX_INFO():
    AMSI_UAC_REQUEST_AX_INFO = win32more.System.Antimalware.AMSI_UAC_REQUEST_AX_INFO_head
    AMSI_UAC_REQUEST_AX_INFO._fields_ = [
        ("ulLength", UInt32),
        ("lpwszLocalInstallPath", win32more.Foundation.PWSTR),
        ("lpwszSourceURL", win32more.Foundation.PWSTR),
    ]
    return AMSI_UAC_REQUEST_AX_INFO
def _define_AMSI_UAC_REQUEST_PACKAGED_APP_INFO_head():
    class AMSI_UAC_REQUEST_PACKAGED_APP_INFO(Structure):
        pass
    return AMSI_UAC_REQUEST_PACKAGED_APP_INFO
def _define_AMSI_UAC_REQUEST_PACKAGED_APP_INFO():
    AMSI_UAC_REQUEST_PACKAGED_APP_INFO = win32more.System.Antimalware.AMSI_UAC_REQUEST_PACKAGED_APP_INFO_head
    AMSI_UAC_REQUEST_PACKAGED_APP_INFO._fields_ = [
        ("ulLength", UInt32),
        ("lpwszApplicationName", win32more.Foundation.PWSTR),
        ("lpwszCommandLine", win32more.Foundation.PWSTR),
        ("lpPackageFamilyName", win32more.Foundation.PWSTR),
        ("lpApplicationId", win32more.Foundation.PWSTR),
    ]
    return AMSI_UAC_REQUEST_PACKAGED_APP_INFO
def _define_AMSI_UAC_REQUEST_CONTEXT_head():
    class AMSI_UAC_REQUEST_CONTEXT(Structure):
        pass
    return AMSI_UAC_REQUEST_CONTEXT
def _define_AMSI_UAC_REQUEST_CONTEXT():
    AMSI_UAC_REQUEST_CONTEXT = win32more.System.Antimalware.AMSI_UAC_REQUEST_CONTEXT_head
    class AMSI_UAC_REQUEST_CONTEXT__RequestType_e__Union(Union):
        pass
    AMSI_UAC_REQUEST_CONTEXT__RequestType_e__Union._fields_ = [
        ("ExeInfo", win32more.System.Antimalware.AMSI_UAC_REQUEST_EXE_INFO),
        ("ComInfo", win32more.System.Antimalware.AMSI_UAC_REQUEST_COM_INFO),
        ("MsiInfo", win32more.System.Antimalware.AMSI_UAC_REQUEST_MSI_INFO),
        ("ActiveXInfo", win32more.System.Antimalware.AMSI_UAC_REQUEST_AX_INFO),
        ("PackagedAppInfo", win32more.System.Antimalware.AMSI_UAC_REQUEST_PACKAGED_APP_INFO),
    ]
    AMSI_UAC_REQUEST_CONTEXT._fields_ = [
        ("ulLength", UInt32),
        ("ulRequestorProcessId", UInt32),
        ("UACTrustState", win32more.System.Antimalware.AMSI_UAC_TRUST_STATE),
        ("Type", win32more.System.Antimalware.AMSI_UAC_REQUEST_TYPE),
        ("RequestType", AMSI_UAC_REQUEST_CONTEXT__RequestType_e__Union),
        ("bAutoElevateRequest", win32more.Foundation.BOOL),
    ]
    return AMSI_UAC_REQUEST_CONTEXT
def _define_IAmsiStream_head():
    class IAmsiStream(win32more.System.Com.IUnknown_head):
        Guid = Guid('3e47f2e5-81d4-4d3b-897f-545096770373')
    return IAmsiStream
def _define_IAmsiStream():
    IAmsiStream = win32more.System.Antimalware.IAmsiStream_head
    IAmsiStream.GetAttribute = COMMETHOD(WINFUNCTYPE(win32more.Foundation.HRESULT,win32more.System.Antimalware.AMSI_ATTRIBUTE,UInt32,POINTER(Byte),POINTER(UInt32), use_last_error=False)(3, 'GetAttribute', ((1, 'attribute'),(1, 'dataSize'),(1, 'data'),(1, 'retData'),)))
    IAmsiStream.Read = COMMETHOD(WINFUNCTYPE(win32more.Foundation.HRESULT,UInt64,UInt32,POINTER(Byte),POINTER(UInt32), use_last_error=False)(4, 'Read', ((1, 'position'),(1, 'size'),(1, 'buffer'),(1, 'readSize'),)))
    return IAmsiStream
def _define_IAntimalwareProvider_head():
    class IAntimalwareProvider(win32more.System.Com.IUnknown_head):
        Guid = Guid('b2cabfe3-fe04-42b1-a5df-08d483d4d125')
    return IAntimalwareProvider
def _define_IAntimalwareProvider():
    IAntimalwareProvider = win32more.System.Antimalware.IAntimalwareProvider_head
    IAntimalwareProvider.Scan = COMMETHOD(WINFUNCTYPE(win32more.Foundation.HRESULT,win32more.System.Antimalware.IAmsiStream_head,POINTER(win32more.System.Antimalware.AMSI_RESULT), use_last_error=False)(3, 'Scan', ((1, 'stream'),(1, 'result'),)))
    IAntimalwareProvider.CloseSession = COMMETHOD(WINFUNCTYPE(Void,UInt64, use_last_error=False)(4, 'CloseSession', ((1, 'session'),)))
    IAntimalwareProvider.DisplayName = COMMETHOD(WINFUNCTYPE(win32more.Foundation.HRESULT,POINTER(win32more.Foundation.PWSTR), use_last_error=False)(5, 'DisplayName', ((1, 'displayName'),)))
    return IAntimalwareProvider
def _define_IAntimalwareUacProvider_head():
    class IAntimalwareUacProvider(win32more.System.Com.IUnknown_head):
        Guid = Guid('b2cabfe4-fe04-42b1-a5df-08d483d4d125')
    return IAntimalwareUacProvider
def _define_IAntimalwareUacProvider():
    IAntimalwareUacProvider = win32more.System.Antimalware.IAntimalwareUacProvider_head
    IAntimalwareUacProvider.UacScan = COMMETHOD(WINFUNCTYPE(win32more.Foundation.HRESULT,POINTER(win32more.System.Antimalware.AMSI_UAC_REQUEST_CONTEXT_head),POINTER(win32more.System.Antimalware.AMSI_RESULT), use_last_error=False)(3, 'UacScan', ((1, 'context'),(1, 'result'),)))
    IAntimalwareUacProvider.DisplayName = COMMETHOD(WINFUNCTYPE(win32more.Foundation.HRESULT,POINTER(win32more.Foundation.PWSTR), use_last_error=False)(4, 'DisplayName', ((1, 'displayName'),)))
    return IAntimalwareUacProvider
def _define_IAntimalwareProvider2_head():
    class IAntimalwareProvider2(win32more.System.Antimalware.IAntimalwareProvider_head):
        Guid = Guid('7c1e6570-3f73-4e0f-8ad4-98b94cd3290f')
    return IAntimalwareProvider2
def _define_IAntimalwareProvider2():
    IAntimalwareProvider2 = win32more.System.Antimalware.IAntimalwareProvider2_head
    IAntimalwareProvider2.Notify = COMMETHOD(WINFUNCTYPE(win32more.Foundation.HRESULT,c_void_p,UInt32,win32more.Foundation.PWSTR,win32more.Foundation.PWSTR,POINTER(win32more.System.Antimalware.AMSI_RESULT), use_last_error=False)(6, 'Notify', ((1, 'buffer'),(1, 'length'),(1, 'contentName'),(1, 'appName'),(1, 'pResult'),)))
    return IAntimalwareProvider2
def _define_IAntimalware_head():
    class IAntimalware(win32more.System.Com.IUnknown_head):
        Guid = Guid('82d29c2e-f062-44e6-b5c9-3d9a2f24a2df')
    return IAntimalware
def _define_IAntimalware():
    IAntimalware = win32more.System.Antimalware.IAntimalware_head
    IAntimalware.Scan = COMMETHOD(WINFUNCTYPE(win32more.Foundation.HRESULT,win32more.System.Antimalware.IAmsiStream_head,POINTER(win32more.System.Antimalware.AMSI_RESULT),POINTER(win32more.System.Antimalware.IAntimalwareProvider_head), use_last_error=False)(3, 'Scan', ((1, 'stream'),(1, 'result'),(1, 'provider'),)))
    IAntimalware.CloseSession = COMMETHOD(WINFUNCTYPE(Void,UInt64, use_last_error=False)(4, 'CloseSession', ((1, 'session'),)))
    return IAntimalware
def _define_IAntimalware2_head():
    class IAntimalware2(win32more.System.Antimalware.IAntimalware_head):
        Guid = Guid('301035b5-2d42-4f56-8c65-2dcaa7fb3cdc')
    return IAntimalware2
def _define_IAntimalware2():
    IAntimalware2 = win32more.System.Antimalware.IAntimalware2_head
    IAntimalware2.Notify = COMMETHOD(WINFUNCTYPE(win32more.Foundation.HRESULT,c_void_p,UInt32,win32more.Foundation.PWSTR,win32more.Foundation.PWSTR,POINTER(win32more.System.Antimalware.AMSI_RESULT), use_last_error=False)(5, 'Notify', ((1, 'buffer'),(1, 'length'),(1, 'contentName'),(1, 'appName'),(1, 'pResult'),)))
    return IAntimalware2
CAntimalware = Guid('fdb00e52-a214-4aa1-8fba-4357bb0072ec')
HAMSICONTEXT = IntPtr
HAMSISESSION = IntPtr
def _define_AmsiInitialize():
    try:
        return WINFUNCTYPE(win32more.Foundation.HRESULT,win32more.Foundation.PWSTR,POINTER(win32more.System.Antimalware.HAMSICONTEXT), use_last_error=False)(("AmsiInitialize", windll["Amsi"]), ((1, 'appName'),(1, 'amsiContext'),))
    except (FileNotFoundError, AttributeError):
        return None
def _define_AmsiUninitialize():
    try:
        return WINFUNCTYPE(Void,win32more.System.Antimalware.HAMSICONTEXT, use_last_error=False)(("AmsiUninitialize", windll["Amsi"]), ((1, 'amsiContext'),))
    except (FileNotFoundError, AttributeError):
        return None
def _define_AmsiOpenSession():
    try:
        return WINFUNCTYPE(win32more.Foundation.HRESULT,win32more.System.Antimalware.HAMSICONTEXT,POINTER(win32more.System.Antimalware.HAMSISESSION), use_last_error=False)(("AmsiOpenSession", windll["Amsi"]), ((1, 'amsiContext'),(1, 'amsiSession'),))
    except (FileNotFoundError, AttributeError):
        return None
def _define_AmsiCloseSession():
    try:
        return WINFUNCTYPE(Void,win32more.System.Antimalware.HAMSICONTEXT,win32more.System.Antimalware.HAMSISESSION, use_last_error=False)(("AmsiCloseSession", windll["Amsi"]), ((1, 'amsiContext'),(1, 'amsiSession'),))
    except (FileNotFoundError, AttributeError):
        return None
def _define_AmsiScanBuffer():
    try:
        return WINFUNCTYPE(win32more.Foundation.HRESULT,win32more.System.Antimalware.HAMSICONTEXT,c_void_p,UInt32,win32more.Foundation.PWSTR,win32more.System.Antimalware.HAMSISESSION,POINTER(win32more.System.Antimalware.AMSI_RESULT), use_last_error=False)(("AmsiScanBuffer", windll["Amsi"]), ((1, 'amsiContext'),(1, 'buffer'),(1, 'length'),(1, 'contentName'),(1, 'amsiSession'),(1, 'result'),))
    except (FileNotFoundError, AttributeError):
        return None
def _define_AmsiNotifyOperation():
    try:
        return WINFUNCTYPE(win32more.Foundation.HRESULT,win32more.System.Antimalware.HAMSICONTEXT,c_void_p,UInt32,win32more.Foundation.PWSTR,POINTER(win32more.System.Antimalware.AMSI_RESULT), use_last_error=False)(("AmsiNotifyOperation", windll["Amsi"]), ((1, 'amsiContext'),(1, 'buffer'),(1, 'length'),(1, 'contentName'),(1, 'result'),))
    except (FileNotFoundError, AttributeError):
        return None
def _define_AmsiScanString():
    try:
        return WINFUNCTYPE(win32more.Foundation.HRESULT,win32more.System.Antimalware.HAMSICONTEXT,win32more.Foundation.PWSTR,win32more.Foundation.PWSTR,win32more.System.Antimalware.HAMSISESSION,POINTER(win32more.System.Antimalware.AMSI_RESULT), use_last_error=False)(("AmsiScanString", windll["Amsi"]), ((1, 'amsiContext'),(1, 'string'),(1, 'contentName'),(1, 'amsiSession'),(1, 'result'),))
    except (FileNotFoundError, AttributeError):
        return None
def _define_InstallELAMCertificateInfo():
    try:
        return WINFUNCTYPE(win32more.Foundation.BOOL,win32more.Foundation.HANDLE, use_last_error=True)(("InstallELAMCertificateInfo", windll["KERNEL32"]), ((1, 'ELAMFile'),))
    except (FileNotFoundError, AttributeError):
        return None
__all__ = [
    "AMSI_RESULT",
    "AMSI_RESULT_CLEAN",
    "AMSI_RESULT_NOT_DETECTED",
    "AMSI_RESULT_BLOCKED_BY_ADMIN_START",
    "AMSI_RESULT_BLOCKED_BY_ADMIN_END",
    "AMSI_RESULT_DETECTED",
    "AMSI_ATTRIBUTE",
    "AMSI_ATTRIBUTE_APP_NAME",
    "AMSI_ATTRIBUTE_CONTENT_NAME",
    "AMSI_ATTRIBUTE_CONTENT_SIZE",
    "AMSI_ATTRIBUTE_CONTENT_ADDRESS",
    "AMSI_ATTRIBUTE_SESSION",
    "AMSI_ATTRIBUTE_REDIRECT_CHAIN_SIZE",
    "AMSI_ATTRIBUTE_REDIRECT_CHAIN_ADDRESS",
    "AMSI_ATTRIBUTE_ALL_SIZE",
    "AMSI_ATTRIBUTE_ALL_ADDRESS",
    "AMSI_ATTRIBUTE_QUIET",
    "AMSI_UAC_REQUEST_TYPE",
    "AMSI_UAC_REQUEST_TYPE_EXE",
    "AMSI_UAC_REQUEST_TYPE_COM",
    "AMSI_UAC_REQUEST_TYPE_MSI",
    "AMSI_UAC_REQUEST_TYPE_AX",
    "AMSI_UAC_REQUEST_TYPE_PACKAGED_APP",
    "AMSI_UAC_REQUEST_TYPE_MAX",
    "AMSI_UAC_TRUST_STATE",
    "AMSI_UAC_TRUST_STATE_TRUSTED",
    "AMSI_UAC_TRUST_STATE_UNTRUSTED",
    "AMSI_UAC_TRUST_STATE_BLOCKED",
    "AMSI_UAC_TRUST_STATE_MAX",
    "AMSI_UAC_MSI_ACTION",
    "AMSI_UAC_MSI_ACTION_INSTALL",
    "AMSI_UAC_MSI_ACTION_UNINSTALL",
    "AMSI_UAC_MSI_ACTION_UPDATE",
    "AMSI_UAC_MSI_ACTION_MAINTENANCE",
    "AMSI_UAC_MSI_ACTION_MAX",
    "AMSI_UAC_REQUEST_EXE_INFO",
    "AMSI_UAC_REQUEST_COM_INFO",
    "AMSI_UAC_REQUEST_MSI_INFO",
    "AMSI_UAC_REQUEST_AX_INFO",
    "AMSI_UAC_REQUEST_PACKAGED_APP_INFO",
    "AMSI_UAC_REQUEST_CONTEXT",
    "IAmsiStream",
    "IAntimalwareProvider",
    "IAntimalwareUacProvider",
    "IAntimalwareProvider2",
    "IAntimalware",
    "IAntimalware2",
    "CAntimalware",
    "HAMSICONTEXT",
    "HAMSISESSION",
    "AmsiInitialize",
    "AmsiUninitialize",
    "AmsiOpenSession",
    "AmsiCloseSession",
    "AmsiScanBuffer",
    "AmsiNotifyOperation",
    "AmsiScanString",
    "InstallELAMCertificateInfo",
]
