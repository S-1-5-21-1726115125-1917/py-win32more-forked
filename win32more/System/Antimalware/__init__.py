from __future__ import annotations
from ctypes import c_void_p, Structure, Union, POINTER, CFUNCTYPE, WINFUNCTYPE, cdll, windll
from win32more.base import MissingType, c_char_p_no, c_wchar_p_no, Byte, SByte, Char, Int16, UInt16, Int32, UInt32, Int64, UInt64, IntPtr, UIntPtr, Single, Double, String, Boolean, Void, Guid, SUCCEEDED, FAILED, cfunctype, winfunctype, commethod, cfunctype_pointer, winfunctype_pointer, press, make_head
import win32more.Foundation
import win32more.System.Antimalware
import win32more.System.Com
import sys
_module = sys.modules[__name__]
def __getattr__(name):
    try:
        prototype = globals()[f'{name}_head']
    except KeyError:
        raise AttributeError(f"module '{__name__}' has no attribute '{name}'") from None
    setattr(_module, name, press(prototype))
    return getattr(_module, name)
def __dir__():
    return __all__
AMSI_ATTRIBUTE = Int32
AMSI_ATTRIBUTE_APP_NAME: AMSI_ATTRIBUTE = 0
AMSI_ATTRIBUTE_CONTENT_NAME: AMSI_ATTRIBUTE = 1
AMSI_ATTRIBUTE_CONTENT_SIZE: AMSI_ATTRIBUTE = 2
AMSI_ATTRIBUTE_CONTENT_ADDRESS: AMSI_ATTRIBUTE = 3
AMSI_ATTRIBUTE_SESSION: AMSI_ATTRIBUTE = 4
AMSI_ATTRIBUTE_REDIRECT_CHAIN_SIZE: AMSI_ATTRIBUTE = 5
AMSI_ATTRIBUTE_REDIRECT_CHAIN_ADDRESS: AMSI_ATTRIBUTE = 6
AMSI_ATTRIBUTE_ALL_SIZE: AMSI_ATTRIBUTE = 7
AMSI_ATTRIBUTE_ALL_ADDRESS: AMSI_ATTRIBUTE = 8
AMSI_ATTRIBUTE_QUIET: AMSI_ATTRIBUTE = 9
AMSI_RESULT = Int32
AMSI_RESULT_CLEAN: AMSI_RESULT = 0
AMSI_RESULT_NOT_DETECTED: AMSI_RESULT = 1
AMSI_RESULT_BLOCKED_BY_ADMIN_START: AMSI_RESULT = 16384
AMSI_RESULT_BLOCKED_BY_ADMIN_END: AMSI_RESULT = 20479
AMSI_RESULT_DETECTED: AMSI_RESULT = 32768
AMSI_UAC_MSI_ACTION = Int32
AMSI_UAC_MSI_ACTION_INSTALL: AMSI_UAC_MSI_ACTION = 0
AMSI_UAC_MSI_ACTION_UNINSTALL: AMSI_UAC_MSI_ACTION = 1
AMSI_UAC_MSI_ACTION_UPDATE: AMSI_UAC_MSI_ACTION = 2
AMSI_UAC_MSI_ACTION_MAINTENANCE: AMSI_UAC_MSI_ACTION = 3
AMSI_UAC_MSI_ACTION_MAX: AMSI_UAC_MSI_ACTION = 4
class AMSI_UAC_REQUEST_AX_INFO(Structure):
    ulLength: UInt32
    lpwszLocalInstallPath: win32more.Foundation.PWSTR
    lpwszSourceURL: win32more.Foundation.PWSTR
class AMSI_UAC_REQUEST_COM_INFO(Structure):
    ulLength: UInt32
    lpwszServerBinary: win32more.Foundation.PWSTR
    lpwszRequestor: win32more.Foundation.PWSTR
    Clsid: Guid
class AMSI_UAC_REQUEST_CONTEXT(Structure):
    ulLength: UInt32
    ulRequestorProcessId: UInt32
    UACTrustState: win32more.System.Antimalware.AMSI_UAC_TRUST_STATE
    Type: win32more.System.Antimalware.AMSI_UAC_REQUEST_TYPE
    RequestType: _RequestType_e__Union
    bAutoElevateRequest: win32more.Foundation.BOOL
    class _RequestType_e__Union(Union):
        ExeInfo: win32more.System.Antimalware.AMSI_UAC_REQUEST_EXE_INFO
        ComInfo: win32more.System.Antimalware.AMSI_UAC_REQUEST_COM_INFO
        MsiInfo: win32more.System.Antimalware.AMSI_UAC_REQUEST_MSI_INFO
        ActiveXInfo: win32more.System.Antimalware.AMSI_UAC_REQUEST_AX_INFO
        PackagedAppInfo: win32more.System.Antimalware.AMSI_UAC_REQUEST_PACKAGED_APP_INFO
class AMSI_UAC_REQUEST_EXE_INFO(Structure):
    ulLength: UInt32
    lpwszApplicationName: win32more.Foundation.PWSTR
    lpwszCommandLine: win32more.Foundation.PWSTR
    lpwszDLLParameter: win32more.Foundation.PWSTR
class AMSI_UAC_REQUEST_MSI_INFO(Structure):
    ulLength: UInt32
    MsiAction: win32more.System.Antimalware.AMSI_UAC_MSI_ACTION
    lpwszProductName: win32more.Foundation.PWSTR
    lpwszVersion: win32more.Foundation.PWSTR
    lpwszLanguage: win32more.Foundation.PWSTR
    lpwszManufacturer: win32more.Foundation.PWSTR
    lpwszPackagePath: win32more.Foundation.PWSTR
    lpwszPackageSource: win32more.Foundation.PWSTR
    ulUpdates: UInt32
    ppwszUpdates: POINTER(win32more.Foundation.PWSTR)
    ppwszUpdateSources: POINTER(win32more.Foundation.PWSTR)
class AMSI_UAC_REQUEST_PACKAGED_APP_INFO(Structure):
    ulLength: UInt32
    lpwszApplicationName: win32more.Foundation.PWSTR
    lpwszCommandLine: win32more.Foundation.PWSTR
    lpPackageFamilyName: win32more.Foundation.PWSTR
    lpApplicationId: win32more.Foundation.PWSTR
AMSI_UAC_REQUEST_TYPE = Int32
AMSI_UAC_REQUEST_TYPE_EXE: AMSI_UAC_REQUEST_TYPE = 0
AMSI_UAC_REQUEST_TYPE_COM: AMSI_UAC_REQUEST_TYPE = 1
AMSI_UAC_REQUEST_TYPE_MSI: AMSI_UAC_REQUEST_TYPE = 2
AMSI_UAC_REQUEST_TYPE_AX: AMSI_UAC_REQUEST_TYPE = 3
AMSI_UAC_REQUEST_TYPE_PACKAGED_APP: AMSI_UAC_REQUEST_TYPE = 4
AMSI_UAC_REQUEST_TYPE_MAX: AMSI_UAC_REQUEST_TYPE = 5
AMSI_UAC_TRUST_STATE = Int32
AMSI_UAC_TRUST_STATE_TRUSTED: AMSI_UAC_TRUST_STATE = 0
AMSI_UAC_TRUST_STATE_UNTRUSTED: AMSI_UAC_TRUST_STATE = 1
AMSI_UAC_TRUST_STATE_BLOCKED: AMSI_UAC_TRUST_STATE = 2
AMSI_UAC_TRUST_STATE_MAX: AMSI_UAC_TRUST_STATE = 3
@winfunctype('Amsi.dll')
def AmsiInitialize(appName: win32more.Foundation.PWSTR, amsiContext: POINTER(win32more.System.Antimalware.HAMSICONTEXT)) -> win32more.Foundation.HRESULT: ...
@winfunctype('Amsi.dll')
def AmsiUninitialize(amsiContext: win32more.System.Antimalware.HAMSICONTEXT) -> Void: ...
@winfunctype('Amsi.dll')
def AmsiOpenSession(amsiContext: win32more.System.Antimalware.HAMSICONTEXT, amsiSession: POINTER(win32more.System.Antimalware.HAMSISESSION)) -> win32more.Foundation.HRESULT: ...
@winfunctype('Amsi.dll')
def AmsiCloseSession(amsiContext: win32more.System.Antimalware.HAMSICONTEXT, amsiSession: win32more.System.Antimalware.HAMSISESSION) -> Void: ...
@winfunctype('Amsi.dll')
def AmsiScanBuffer(amsiContext: win32more.System.Antimalware.HAMSICONTEXT, buffer: c_void_p, length: UInt32, contentName: win32more.Foundation.PWSTR, amsiSession: win32more.System.Antimalware.HAMSISESSION, result: POINTER(win32more.System.Antimalware.AMSI_RESULT)) -> win32more.Foundation.HRESULT: ...
@winfunctype('Amsi.dll')
def AmsiNotifyOperation(amsiContext: win32more.System.Antimalware.HAMSICONTEXT, buffer: c_void_p, length: UInt32, contentName: win32more.Foundation.PWSTR, result: POINTER(win32more.System.Antimalware.AMSI_RESULT)) -> win32more.Foundation.HRESULT: ...
@winfunctype('Amsi.dll')
def AmsiScanString(amsiContext: win32more.System.Antimalware.HAMSICONTEXT, string: win32more.Foundation.PWSTR, contentName: win32more.Foundation.PWSTR, amsiSession: win32more.System.Antimalware.HAMSISESSION, result: POINTER(win32more.System.Antimalware.AMSI_RESULT)) -> win32more.Foundation.HRESULT: ...
@winfunctype('KERNEL32.dll')
def InstallELAMCertificateInfo(ELAMFile: win32more.Foundation.HANDLE) -> win32more.Foundation.BOOL: ...
CAntimalware = Guid('fdb00e52-a214-4aa1-8f-ba-43-57-bb-00-72-ec')
HAMSICONTEXT = IntPtr
HAMSISESSION = IntPtr
class IAmsiStream(c_void_p):
    extends: win32more.System.Com.IUnknown
    Guid = Guid('3e47f2e5-81d4-4d3b-89-7f-54-50-96-77-03-73')
    @commethod(3)
    def GetAttribute(attribute: win32more.System.Antimalware.AMSI_ATTRIBUTE, dataSize: UInt32, data: c_char_p_no, retData: POINTER(UInt32)) -> win32more.Foundation.HRESULT: ...
    @commethod(4)
    def Read(position: UInt64, size: UInt32, buffer: c_char_p_no, readSize: POINTER(UInt32)) -> win32more.Foundation.HRESULT: ...
class IAntimalware(c_void_p):
    extends: win32more.System.Com.IUnknown
    Guid = Guid('82d29c2e-f062-44e6-b5-c9-3d-9a-2f-24-a2-df')
    @commethod(3)
    def Scan(stream: win32more.System.Antimalware.IAmsiStream_head, result: POINTER(win32more.System.Antimalware.AMSI_RESULT), provider: POINTER(win32more.System.Antimalware.IAntimalwareProvider_head)) -> win32more.Foundation.HRESULT: ...
    @commethod(4)
    def CloseSession(session: UInt64) -> Void: ...
class IAntimalware2(c_void_p):
    extends: win32more.System.Antimalware.IAntimalware
    Guid = Guid('301035b5-2d42-4f56-8c-65-2d-ca-a7-fb-3c-dc')
    @commethod(5)
    def Notify(buffer: c_void_p, length: UInt32, contentName: win32more.Foundation.PWSTR, appName: win32more.Foundation.PWSTR, pResult: POINTER(win32more.System.Antimalware.AMSI_RESULT)) -> win32more.Foundation.HRESULT: ...
class IAntimalwareProvider(c_void_p):
    extends: win32more.System.Com.IUnknown
    Guid = Guid('b2cabfe3-fe04-42b1-a5-df-08-d4-83-d4-d1-25')
    @commethod(3)
    def Scan(stream: win32more.System.Antimalware.IAmsiStream_head, result: POINTER(win32more.System.Antimalware.AMSI_RESULT)) -> win32more.Foundation.HRESULT: ...
    @commethod(4)
    def CloseSession(session: UInt64) -> Void: ...
    @commethod(5)
    def DisplayName(displayName: POINTER(win32more.Foundation.PWSTR)) -> win32more.Foundation.HRESULT: ...
class IAntimalwareProvider2(c_void_p):
    extends: win32more.System.Antimalware.IAntimalwareProvider
    Guid = Guid('7c1e6570-3f73-4e0f-8a-d4-98-b9-4c-d3-29-0f')
    @commethod(6)
    def Notify(buffer: c_void_p, length: UInt32, contentName: win32more.Foundation.PWSTR, appName: win32more.Foundation.PWSTR, pResult: POINTER(win32more.System.Antimalware.AMSI_RESULT)) -> win32more.Foundation.HRESULT: ...
class IAntimalwareUacProvider(c_void_p):
    extends: win32more.System.Com.IUnknown
    Guid = Guid('b2cabfe4-fe04-42b1-a5-df-08-d4-83-d4-d1-25')
    @commethod(3)
    def UacScan(context: POINTER(win32more.System.Antimalware.AMSI_UAC_REQUEST_CONTEXT_head), result: POINTER(win32more.System.Antimalware.AMSI_RESULT)) -> win32more.Foundation.HRESULT: ...
    @commethod(4)
    def DisplayName(displayName: POINTER(win32more.Foundation.PWSTR)) -> win32more.Foundation.HRESULT: ...
make_head(_module, 'AMSI_UAC_REQUEST_AX_INFO')
make_head(_module, 'AMSI_UAC_REQUEST_COM_INFO')
make_head(_module, 'AMSI_UAC_REQUEST_CONTEXT')
make_head(_module, 'AMSI_UAC_REQUEST_EXE_INFO')
make_head(_module, 'AMSI_UAC_REQUEST_MSI_INFO')
make_head(_module, 'AMSI_UAC_REQUEST_PACKAGED_APP_INFO')
make_head(_module, 'IAmsiStream')
make_head(_module, 'IAntimalware')
make_head(_module, 'IAntimalware2')
make_head(_module, 'IAntimalwareProvider')
make_head(_module, 'IAntimalwareProvider2')
make_head(_module, 'IAntimalwareUacProvider')
__all__ = [
    "AMSI_ATTRIBUTE",
    "AMSI_ATTRIBUTE_ALL_ADDRESS",
    "AMSI_ATTRIBUTE_ALL_SIZE",
    "AMSI_ATTRIBUTE_APP_NAME",
    "AMSI_ATTRIBUTE_CONTENT_ADDRESS",
    "AMSI_ATTRIBUTE_CONTENT_NAME",
    "AMSI_ATTRIBUTE_CONTENT_SIZE",
    "AMSI_ATTRIBUTE_QUIET",
    "AMSI_ATTRIBUTE_REDIRECT_CHAIN_ADDRESS",
    "AMSI_ATTRIBUTE_REDIRECT_CHAIN_SIZE",
    "AMSI_ATTRIBUTE_SESSION",
    "AMSI_RESULT",
    "AMSI_RESULT_BLOCKED_BY_ADMIN_END",
    "AMSI_RESULT_BLOCKED_BY_ADMIN_START",
    "AMSI_RESULT_CLEAN",
    "AMSI_RESULT_DETECTED",
    "AMSI_RESULT_NOT_DETECTED",
    "AMSI_UAC_MSI_ACTION",
    "AMSI_UAC_MSI_ACTION_INSTALL",
    "AMSI_UAC_MSI_ACTION_MAINTENANCE",
    "AMSI_UAC_MSI_ACTION_MAX",
    "AMSI_UAC_MSI_ACTION_UNINSTALL",
    "AMSI_UAC_MSI_ACTION_UPDATE",
    "AMSI_UAC_REQUEST_AX_INFO",
    "AMSI_UAC_REQUEST_COM_INFO",
    "AMSI_UAC_REQUEST_CONTEXT",
    "AMSI_UAC_REQUEST_EXE_INFO",
    "AMSI_UAC_REQUEST_MSI_INFO",
    "AMSI_UAC_REQUEST_PACKAGED_APP_INFO",
    "AMSI_UAC_REQUEST_TYPE",
    "AMSI_UAC_REQUEST_TYPE_AX",
    "AMSI_UAC_REQUEST_TYPE_COM",
    "AMSI_UAC_REQUEST_TYPE_EXE",
    "AMSI_UAC_REQUEST_TYPE_MAX",
    "AMSI_UAC_REQUEST_TYPE_MSI",
    "AMSI_UAC_REQUEST_TYPE_PACKAGED_APP",
    "AMSI_UAC_TRUST_STATE",
    "AMSI_UAC_TRUST_STATE_BLOCKED",
    "AMSI_UAC_TRUST_STATE_MAX",
    "AMSI_UAC_TRUST_STATE_TRUSTED",
    "AMSI_UAC_TRUST_STATE_UNTRUSTED",
    "AmsiCloseSession",
    "AmsiInitialize",
    "AmsiNotifyOperation",
    "AmsiOpenSession",
    "AmsiScanBuffer",
    "AmsiScanString",
    "AmsiUninitialize",
    "CAntimalware",
    "HAMSICONTEXT",
    "HAMSISESSION",
    "IAmsiStream",
    "IAntimalware",
    "IAntimalware2",
    "IAntimalwareProvider",
    "IAntimalwareProvider2",
    "IAntimalwareUacProvider",
    "InstallELAMCertificateInfo",
]
